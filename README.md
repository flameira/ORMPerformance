# ORMPerformance

Solution to compare ORM performances. NPOCO, EFCore,DAPPER and ADODBNET
The test example it's only to identify which ORM is the best solution to use in .net Core2.
This solution uses the "BenchMarkDonetNet V(0.10.14)" tool.

# First results
With this test I try to use query with some complexity, join, filters and orders.
eg: 
- Join 2 Tables
- Order by Foreing Key
- Filter by the join field id
- Top 100

## 10 Records in the database
 ![
](https://lh3.googleusercontent.com/2a6dk51stMWgabvC-vG5WkqxpT_1m9-21fjpmU4pr4XWKchUbtQvQgQ5l1kROXOdqbmK_-bGlqHabQ "10")

## 1 000 Records in the database take the first 100
***In progresss
## 1 000 Records in the database take the first 500
***In progresss


## 5 000 Records in the database take the first 100
***In progresss
## 5 000 Records in the database take the first 500
***In progresss


## 10 000 Records in the database take the first 100
***In progresss
## 10 000 Records in the database take the first 500
***In progresss


## 50 000 Records in the database take the first 100
***In progresss
## 50 000 Records in the database take the first 500
***In progresss

## 100 000 Records in the database take the first 100
![](https://lh3.googleusercontent.com/TVy8Zsd-OVyW5BiUYEY9hULyD8TK3mw7uVx9u2hcpVfEqH3fvMV7XwkYYd-Z7DnEpZmPRj4BM_Ok3kuRP8pT54nqzjnmxQVlLqhh9km4Vr922N_J8JEbBXNz7rnKGZSroEFwoiQChaZfhrZzFqhUS4cmPhxFM6LYhV9KcfQE64p81jxdjy63AWK6m7C1o2m2Hops8W1ASkj4V_znh8QlJ1xpGFkoDSIRaIcjIxq-NM_sy8tqoDMRK3nJRl5rqNmmx9ssVz6QE7olWdVqCdhIDcG3wo0G_o1FhyhfpFxBfpnuu3y6AYhWvcy-Lo5EAmvTlorothzAYhYokwWDOUDlfodkTKt_8U2FiBjvIbh6Z-4wuRl2x6CA4S8yDZ7XzPh25lHNCFKOxCOf99y9Co9mel5XkBTiZfiRSvFotKTV4lPhoOuCmfeV_i5g0Dh7jxGPoxehuZkTzLJEI0schNgW3uGNPVDf2oSLC6xMi33fpy6gZ8vvWNq80o6PtlWqDbPfgZJkpR6pmz1_cvkP7oSfbK2vj47McoH0XjRgln9TNmDFr7IRSZCJ5f-brJQUnF6c6py5khWFhJYVpsnDC8_vg_qs7cByjbZrurfpbTTB=w795-h621-no "100")

## 100 000 Records in the database take the first 500
![](https://lh3.googleusercontent.com/4l7_eCWnJzV11ZKxn1QMAiTogUZ24xz4wm48mh0wmAFnv5feMm9sNy9NNbPBDcdeTBbwuaDwMEDTOukrzh34o8NkXAbexjuvsqgxGOL_iLbhe2ikbMFbLZzcQfuiuFfKryR4s6K8YXjP9SuEbw4Pq4Gy_iesHokuKirYJINJvujrRa04sRVonXkJXlZosRAUF5kUN7WlyT5s4X8gpnJ1gWtkGyHVTbews3Y4vQogHGWX70HTgsyNV3lb-niNjHXt-ZUTfdxYAyOI9lY1OohU4DFMWG2HjTtYRJWoHq0il_rpD5kB36vKr0BGAzJrj-k4lTpFZPcFFfatTUJ5A-15nC6EAzWY66KJR-Nr1uvTFVyNfH-9EbYHMwHBi4q3U1J9VWvX3pfSoaEfYUmWuFn-NKIf30aitKtV7_Tn27Waaaet540IYNubLdUs5zVGmcF6Utr_Eu1dhqawfdykZ_0OXy3HDWm2ma_zY7y5kZ7ULCyGbbHTobBl3oTC2Jhs8Erh2B-QaaKRVfxSzaUYdXyJ08oana6f0-YOb4CmBLMC9S0XF840bXZch1tD5vdFidAdJ0E-N30wHBXd3f9FPzInmUHA6wDrKenusOG_KWi-=w797-h626-no "500")


## 100 000 Records in the database take the first 1 000
![](https://lh3.googleusercontent.com/F2w5HWdivKm0WIXfeVjdH7MKGLR--dT1EGKmefIekCHeoziv7zDaZnSjy3_lkKcVXheImQwtdv4EOGQoVQcY8sGoGEw5XVG695v0UuOBILkUfjf9R0V68dB30dbncIVgbVpZLoqC_RE8W_Up2K1GZzOc9uREPdUgaj1GOPbk8ccHWDW-6tE0l8AwFG97pb10cm6cv0s52egQvRIC6njwAgl7ci5d1ao1SwJOmXV7ZqyMiToa6HJ3CsQfEMzzS5YHPOERkymhgw5jLLyPHIz3bVxNwpm4-SqlrIewq-vukw2vqCajXjwNHH-fFnUnFIPEBsK720bS1brQ4dAJuuXJIsmx4guC7hwplAMzxWv1Zg19-ZxV9S0k3muBqorYU-Y9V7UAVY3MyBF0JCq0d0J5JfR28Xqj0tXvsX5O49MjHL35JiR0NJRQ_079SZgtCdqN0qdP6RIIeXNOCLHwflIMLG58Fks69ZYmIz6qDYuOEUs6iHhSlQ1GYEA094SVodlVt6zCVZ53SeALq9UDz9G94KKfMuGzJnf1Mv5vu6TAXlxilwMWdQ35cd9_IA9k_oW1oW4Zaat_DqS2VcpiQCm5F2RcDwakIJN68-lcEeiQ=w988-h638-no "1000")

# Queries generated by each ORM
The is the result for each query mady by the ORM, to prove the same sql query results .

## ADODB

```css
exec  sp_executesql  N'SELECT Top 100 CLH.Id, CLH.Description, CLH.CreatedDateTime, 
CLH.UpdatedDateTime, CLH.IsObsolete, CLH.ObsoletedDateTime, CLH.CheckTypeId, CLH.IsSystem, 
CLH.VehicleTypeId, CT.Id AS CT_Id, CT.CreatedDateTime AS CT_CreatedDateTime, 
CT.UpdatedDateTime AS CT_UpdatedDateTime,CT.Name AS CT_Name, CT.IsSystem AS CT_IsSystem 
from CheckListHeader CLH left join CheckType CT on CLH.CheckTypeId=Ct.Id 
where CheckTypeId=@ID 
order by VehicleTypeId asc',N'@ID int',@ID=1
```

## [Dapper](https://github.com/StackExchange/Dapper) V(1.50.4)


```css
SELECT Top 100 CLH.Id, CLH.Description, CLH.CreatedDateTime, CLH.UpdatedDateTime, 
CLH.IsObsolete, CLH.ObsoletedDateTime,CLH.CheckTypeId, CLH.IsSystem, 
CLH.VehicleTypeId, CT.Id AS CT_Id, CT.CreatedDateTime AS CT_CreatedDateTime,
CT.UpdatedDateTime AS CT_UpdatedDateTime, CT.Name AS CT_Name, CT.IsSystem AS CT_IsSystem
from CheckListHeader CLH left join CheckType CT on CLH.CheckTypeId=Ct.Id  
where CheckTypeId=1 order by VehicleTypeId asc
```
## Entity Framework V(2.1.0-preview2-final)

```css
db.CheckListHeader
				                  .Where(b => b.CheckTypeId == CheckTypeId)
				                  .OrderBy(b => b.VehicleTypeId)
				                  .Include(p => p.CheckType).Take(10);
```

```css
exec sp_executesql N'SELECT TOP(@__p_1) [b].[Id], [b].[CheckTypeId], [b].[CreatedDateTime],
[b].[Description], [b].[IsObsolete], [b].[IsSystem], [b].[UpdatedDateTime], [b].[VehicleTypeId], 
[b.CheckType].[Id], [b.CheckType].[CreatedDateTime], [b.CheckType].[IsSystem], 
[b.CheckType].[Name], [b.CheckType].[UpdatedDateTime]
FROM [CheckListHeader] AS [b]
INNER JOIN [CheckType] AS [b.CheckType] ON [b].[CheckTypeId] = [b.CheckType].[Id]
WHERE [b].[CheckTypeId] = @__CheckTypeId_0
ORDER BY [b].[VehicleTypeId]',N'@__p_1 int,@__CheckTypeId_0 int',@__p_1=100,@__CheckTypeId_0=1
```

## [NPOCO](https://github.com/schotime/NPoco/wiki) V(3.9.3)

```css
db.Query<CheckListHeader>()
				                   .Include(m => m.CheckType)
				                   .Where(m => m.CheckTypeId == CheckTypeId)
				                   .OrderBy(m => m.VehicleTypeId)
				                   .Limit(10);
```

```css
exec sp_executesql N'SELECT [CLH].[Description] as [Description], [CLH].[IsObsolete] as [IsObsolete],
[CLH].[IsSystem] as [IsSystem], [CLH].[CheckTypeId] as [CheckTypeId], 
[CLH].[VehicleTypeId] as [VehicleTypeId], [CLH].[Id] as [Id], [CLH].[CreatedDateTime] as [CreatedDateTime], 
[CLH].[UpdatedDateTime] as [UpdatedDateTime], [CT].[Name] as [CheckType__Name], 
[CT].[IsSystem] as [CheckType__IsSystem], [CT].[Id] as [CheckType__Id], 
[CT].[CreatedDateTime] as [CheckType__CreatedDateTime], 
[CT].[UpdatedDateTime] as [CheckType__UpdatedDateTime] FROM [CheckListHeader] [CLH]
LEFT JOIN [CheckType] [CT] ON [CLH].[CheckTypeId] = [CT].[Id]
WHERE ([CLH].[CheckTypeId] = @0)
ORDER BY [VehicleTypeId] ASC
```

# Conclusions

If the project is small with small amount of data, I suggest to use entity framework, but if the project can get a large amount of data It’s very clear [NPOCO](https://github.com/schotime/NPoco/wiki) we should use have the best test performance for more records results, at this moment is very easy to use and it 's possible to have the same functionalities like we have with entity framework, “includes,joins”, exchange data directly with the object using LINQ and for me the most relevant **SQL Transaction Support.**
